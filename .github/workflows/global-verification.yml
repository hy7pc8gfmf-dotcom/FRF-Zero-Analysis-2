name: FRF 2.0 å…¨é‡å¹¶è¡Œå½¢å¼åŒ–éªŒè¯

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  workflow_dispatch:
    inputs:
      parallel_level:
        description: 'å¹¶è¡Œçº§åˆ« (1=ä¸²è¡Œ, 2=ä¸­ç­‰å¹¶è¡Œ, 3=å®Œå…¨å¹¶è¡Œ)'
        required: false
        default: '2'
      memory_limit:
        description: 'å†…å­˜é™åˆ¶ (MB)'
        required: false
        default: '8192'

jobs:
  full-formal-verification:
    runs-on: ubuntu-22.04
    timeout-minutes: 180  # å…¨é‡ç¼–è¯‘å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´
    strategy:
      fail-fast: false  # å…è®¸å•ä¸ªæ¨¡å—å¤±è´¥è€Œä¸ä¸­æ–­å…¨éƒ¨
      matrix:
        parallel_level: [2]  # é»˜è®¤å¹¶è¡Œçº§åˆ«ï¼Œå¯é€šè¿‡workflow_dispatchè¦†ç›–
    env:
      PARALLEL_LEVEL: ${{ github.event.inputs.parallel_level || matrix.parallel_level }}
      MEMORY_LIMIT: ${{ github.event.inputs.memory_limit || 8192 }}
      
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      with:
        fetch-depth: 1
        submodules: false
        
    - name: ğŸ–¥ï¸ ç³»ç»Ÿä¿¡æ¯æ£€æŸ¥
      run: |
        echo "=== ç³»ç»Ÿä¿¡æ¯ ==="
        echo "ç³»ç»Ÿ: $(uname -a)"
        echo "CPUæ ¸å¿ƒ: $(nproc)"
        echo "å¯ç”¨CPUæ ¸å¿ƒ: ${{ env.PARALLEL_LEVEL }}"
        echo "å†…å­˜é™åˆ¶: ${{ env.MEMORY_LIMIT }}MB"
        echo "ç‰©ç†å†…å­˜:"
        free -m
        echo "ç£ç›˜ç©ºé—´:"
        df -h
        echo "å·¥ä½œç›®å½•ç»“æ„:"
        find . -name "*.v" -type f | head -20
        echo "... (æ›´å¤š.væ–‡ä»¶)"

    - name: ğŸ“¦ å®‰è£…ç³»ç»Ÿä¾èµ–ï¼ˆå…¨é‡ç‰ˆï¼‰
      run: |
        echo "å®‰è£…å…¨é‡ç³»ç»Ÿä¾èµ–..."
        sudo apt-get update
        sudo apt-get install -y \
          opam \
          bubblewrap \
          g++ \
          pkg-config \
          m4 \
          rsync \
          git \
          wget \
          bc \
          graphviz \
          texlive-latex-base \
          texlive-fonts-recommended \
          texlive-fonts-extra \
          texlive-latex-extra \
          python3-pip
        echo "âœ… ç³»ç»Ÿä¾èµ–å®‰è£…å®Œæˆ"
        
        # å®‰è£…Coqæ–‡æ¡£å·¥å…·
        pip3 install coq-doc --quiet

    - name: ğŸ”„ åˆå§‹åŒ–OPAMç¯å¢ƒ
      timeout-minutes: 25
      run: |
        echo "åˆå§‹åŒ–OPAMç¯å¢ƒ..."
        opam init --disable-sandboxing -y --compiler=4.14.0
        eval $(opam env)
        opam repo add coq-released https://coq.inria.fr/opam/released
        opam repo add mathcomp https://math-comp.github.io/opam-repository
        opam update
        echo "âœ… OPAMç¯å¢ƒåˆå§‹åŒ–å®Œæˆ"
        echo "OPAMç‰ˆæœ¬: $(opam --version)"
        echo "OPAMå¼€å…³: $(opam switch show)"

    - name: ğŸ“š å®‰è£…Coqæ ¸å¿ƒåŠä¾èµ–
      timeout-minutes: 40
      run: |
        eval $(opam env)
        echo "å®‰è£…Coq 8.18.0åŠæ ¸å¿ƒä¾èµ–..."
        
        # å®‰è£…Coqæ ¸å¿ƒ
        opam install -y --no-depexts \
          coq.8.18.0 \
          coq-stdlib \
          coq-flocq \
          coq-bignums \
          coq-mathcomp-ssreflect.1.17.0 \
          coq-mathcomp-fingroup \
          coq-mathcomp-algebra \
          coq-mathcomp-solvable \
          coq-mathcomp-field \
          coq-mathcomp-character
        
        # å®‰è£…å®æ•°åº“
        opam install -y --no-depexts coq-reals
        
        echo "éªŒè¯å®‰è£…..."
        if coqc --version | grep -q "8.18.0"; then
          echo "âœ… Coq 8.18.0 å®‰è£…æˆåŠŸ"
        else
          echo "âŒ Coqç‰ˆæœ¬ä¸åŒ¹é…"
          exit 1
        fi

        echo "å·²å®‰è£…åŒ…åˆ—è¡¨:"
        opam list --installed --short | grep -E "coq|mathcomp" | sort

    - name: ğŸ› ï¸ å®‰è£…å¯é€‰å¤–éƒ¨åº“
      timeout-minutes: 20
      continue-on-error: true  # å¤–éƒ¨åº“ä¸æ˜¯å¿…éœ€çš„
      run: |
        eval $(opam env)
        echo "å°è¯•å®‰è£…å¯é€‰å¤–éƒ¨åº“..."
        
        # å°è¯•å®‰è£…Mathlib (å¦‚æœå¯ç”¨)
        if opam info coq-mathlib &>/dev/null; then
          echo "å®‰è£…Mathlib..."
          opam install -y --no-depexts coq-mathlib
        else
          echo "Mathlibä¸å¯ç”¨ï¼Œè·³è¿‡"
        fi
        
        # å®‰è£…å…¶ä»–æœ‰ç”¨çš„Coqåº“
        opam install -y --no-depexts \
          coq-ext-lib \
          coq-simple-io \
          coq-quickchick || echo "éƒ¨åˆ†åº“å®‰è£…å¤±è´¥ï¼Œç»§ç»­..."

    - name: ğŸ“ é¡¹ç›®ç»“æ„éªŒè¯
      run: |
        echo "=== é¡¹ç›®ç»“æ„éªŒè¯ ==="
        echo "æ€».væ–‡ä»¶æ•°é‡: $(find . -name "*.v" -type f | wc -l)"
        echo "æŒ‰ç›®å½•ç»Ÿè®¡:"
        for dir in SelfContainedLib theories Quantum CS_Null Test; do
          count=$(find "$dir" -name "*.v" -type f 2>/dev/null | wc -l)
          echo "  $dir/: $count ä¸ªæ–‡ä»¶"
        done
        
        echo ""
        echo "å…³é”®æ–‡ä»¶æ£€æŸ¥:"
        required_files=(
          "SelfContainedLib/Algebra.v"
          "SelfContainedLib/Geometry.v"
          "SelfContainedLib/Category.v"
          "theories/FRF_MetaTheory.v"
          "theories/ChurchZero.v"
          "theories/ChurchNumerals.v"
          "CS_Null/FRF_CS_Null_Common.v"
          "theories/FRF_Comparative.v"
        )
        
        for file in "${required_files[@]}"; do
          if [ -f "$file" ]; then
            lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            echo "  âœ… $file ($lines è¡Œ)"
          else
            echo "  âŒ $file (ç¼ºå¤±)"
          fi
        done

    - name: ğŸ”§ é…ç½®ç¼–è¯‘ç¯å¢ƒ
      run: |
        echo "é…ç½®ç¼–è¯‘ç¯å¢ƒ..."
        eval $(opam env)
        
        # åˆ›å»ºç¼–è¯‘é…ç½®æ–‡ä»¶
        cat > coq_config.mk << 'EOF'
# FRF 2.0 ç¼–è¯‘é…ç½®
COQC = coqc
COQDEP = coqdep
COQFLAGS = -w -deprecated
MEMORY_LIMIT = ${{ env.MEMORY_LIMIT }}
PARALLEL_JOBS = ${{ env.PARALLEL_LEVEL }}

# è·¯å¾„é…ç½®
BASE_FLAGS = \
  -Q SelfContainedLib SelfContainedLib \
  -Q theories FRF.Theories \
  -Q Quantum FRF.Quantum \
  -Q CS_Null FRF.CS_Null \
  -Q Test FRF.Test

# å¤§æ–‡ä»¶ç‰¹æ®Šå¤„ç†
HUGE_FILES = \
  SelfContainedLib/Geometry.v \
  theories/FRF_MetaTheory.v \
  theories/ChurchNumerals.v \
  CS_Null/FRF_CS_Null_Common.v \
  theories/FRF_Comparative.v

# å¹¶è¡Œç¼–è¯‘å‡½æ•°
define parallel_compile
  @echo "å¹¶è¡Œç¼–è¯‘ $1 ä¸ªæ–‡ä»¶..."
  @i=0; \
  for file in $2; do \
    echo "å¯åŠ¨: $$(basename $$file)"; \
    $(COQC) $(BASE_FLAGS) $(COQFLAGS) -m $(MEMORY_LIMIT) "$$file" & \
    pids[$$i]=$$!; \
    i=$$((i+1)); \
    if [ $$((i % $(PARALLEL_JOBS))) -eq 0 ]; then \
      for pid in $${pids[@]}; do wait $$pid; done; \
      pids=(); i=0; \
    fi; \
  done; \
  for pid in $${pids[@]}; do wait $$pid; done
endef
EOF
        
        echo "âœ… ç¼–è¯‘é…ç½®ç”Ÿæˆå®Œæˆ"
        echo "é…ç½®å†…å®¹:"
        cat coq_config.mk | head -20

    - name: ğŸ—ï¸ ç¬¬ä¸€æ­¥ï¼šç¼–è¯‘è‡ªåŒ…å«åŸºç¡€åº“ï¼ˆå¹¶è¡Œï¼‰
      timeout-minutes: 25
      run: |
        echo "=== ç¬¬ä¸€æ­¥ï¼šç¼–è¯‘è‡ªåŒ…å«åŸºç¡€åº“ ==="
        eval $(opam env)
        source coq_config.mk
        
        echo "æ£€æµ‹æ–‡ä»¶å¤§å°å’Œä¾èµ–..."
        BASE_FILES="SelfContainedLib/Algebra.v SelfContainedLib/Category.v SelfContainedLib/Geometry.v"
        
        for file in $BASE_FILES; do
          if [ -f "$file" ]; then
            lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            echo "  $(basename $file): $lines è¡Œ"
          fi
        done
        
        echo "å¼€å§‹å¹¶è¡Œç¼–è¯‘..."
        # ä½¿ç”¨å¹¶è¡Œç¼–è¯‘å‡½æ•°
        $(call parallel_compile,3,"$BASE_FILES")
        
        echo "éªŒè¯ç¼–è¯‘ç»“æœ..."
        success=0
        for file in $BASE_FILES; do
          vo_file="${file%.v}.vo"
          if [ -f "$vo_file" ]; then
            echo "  âœ… $(basename $vo_file) ç”ŸæˆæˆåŠŸ"
            success=$((success+1))
          else
            echo "  âŒ $(basename $vo_file) ç”Ÿæˆå¤±è´¥"
          fi
        done
        
        if [ $success -eq 3 ]; then
          echo "ğŸ‰ åŸºç¡€åº“å…¨éƒ¨ç¼–è¯‘æˆåŠŸ"
        else
          echo "âš ï¸  åŸºç¡€åº“ç¼–è¯‘éƒ¨åˆ†å¤±è´¥ ($success/3)"
        fi

    - name: ğŸ—ï¸ ç¬¬äºŒæ­¥ï¼šç¼–è¯‘FRFå…ƒç†è®ºå±‚ï¼ˆå¹¶è¡Œï¼‰
      timeout-minutes: 30
      run: |
        echo "=== ç¬¬äºŒæ­¥ï¼šç¼–è¯‘FRFå…ƒç†è®ºå±‚ ==="
        eval $(opam env)
        source coq_config.mk
        
        echo "æ£€æµ‹å¤§æ–‡ä»¶..."
        FRF_FILES="theories/FRF_MetaTheory.v theories/ChurchZero.v theories/ChurchNumerals.v"
        
        for file in $FRF_FILES; do
          if [ -f "$file" ]; then
            lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            is_huge=""
            for huge in $HUGE_FILES; do
              if [ "$file" = "$huge" ]; then
                is_huge=" (å¤§æ–‡ä»¶)"
                break
              fi
            done
            echo "  $(basename $file): $lines è¡Œ$is_huge"
          fi
        done
        
        echo "å¼€å§‹ç¼–è¯‘..."
        # å¯¹å¤§æ–‡ä»¶ä½¿ç”¨å¢å¼ºå‚æ•°
        for file in $FRF_FILES; do
          echo "ç¼–è¯‘: $(basename $file)"
          is_huge=0
          for huge in $HUGE_FILES; do
            if [ "$file" = "$huge" ]; then
              is_huge=1
              break
            fi
          done
          
          if [ $is_huge -eq 1 ]; then
            # å¤§æ–‡ä»¶ä½¿ç”¨ä¸²è¡Œç¼–è¯‘å’Œæ›´å¤šå†…å­˜
            echo "  å¤§æ–‡ä»¶ï¼Œä½¿ç”¨ä¸²è¡Œç¼–è¯‘..."
            $COQC $BASE_FLAGS $COQFLAGS -m $((MEMORY_LIMIT * 2)) "$file"
          else
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file"
          fi &
        done
        wait
        
        echo "éªŒè¯ç¼–è¯‘ç»“æœ..."
        success=0
        for file in $FRF_FILES; do
          vo_file="${file%.v}.vo"
          if [ -f "$vo_file" ]; then
            echo "  âœ… $(basename $vo_file) ç”ŸæˆæˆåŠŸ"
            success=$((success+1))
          else
            echo "  âŒ $(basename $vo_file) ç”Ÿæˆå¤±è´¥"
          fi
        done

    - name: ğŸ—ï¸ ç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘æ•°å­¦åœºæ™¯å±‚ï¼ˆåˆ†ç»„å¹¶è¡Œï¼‰
      timeout-minutes: 35
      run: |
        echo "=== ç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘æ•°å­¦åœºæ™¯å±‚ ==="
        eval $(opam env)
        source coq_config.mk
        
        # åˆ†ç»„ç¼–è¯‘ï¼šå…ˆç¼–è¯‘ç‹¬ç«‹åœºæ™¯ï¼Œå†ç¼–è¯‘ä¾èµ–åœºæ™¯
        SCENE_GROUP1="theories/CaseA_SetTheory.v theories/CaseB_Algebra.v theories/CaseC_TypeTheory.v"
        SCENE_GROUP2="theories/CaseD_CategoryTheory.v Quantum/CaseE_QuantumVacuum.v"
        
        echo "ç¼–è¯‘ç¬¬ä¸€ç»„ï¼ˆç‹¬ç«‹åœºæ™¯ï¼‰..."
        for file in $SCENE_GROUP1; do
          if [ -f "$file" ]; then
            echo "ç¼–è¯‘: $(basename $file)"
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file" &
          fi
        done
        wait
        
        echo "ç¼–è¯‘ç¬¬äºŒç»„ï¼ˆä¾èµ–åœºæ™¯ï¼‰..."
        for file in $SCENE_GROUP2; do
          if [ -f "$file" ]; then
            echo "ç¼–è¯‘: $(basename $file)"
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file" &
          fi
        done
        wait
        
        echo "éªŒè¯æ•°å­¦åœºæ™¯ç¼–è¯‘..."
        ALL_SCENES="$SCENE_GROUP1 $SCENE_GROUP2"
        success=0
        total=0
        for file in $ALL_SCENES; do
          total=$((total+1))
          vo_file="${file%.v}.vo"
          if [ -f "$vo_file" ]; then
            echo "  âœ… $(basename $vo_file) ç”ŸæˆæˆåŠŸ"
            success=$((success+1))
          elif [ -f "$file" ]; then
            echo "  âŒ $(basename $vo_file) ç”Ÿæˆå¤±è´¥"
          fi
        done
        
        echo "æ•°å­¦åœºæ™¯ç¼–è¯‘: $success/$total æˆåŠŸ"

    - name: ğŸ—ï¸ ç¬¬å››æ­¥ï¼šç¼–è¯‘æ‰©å±•æ¨¡å—ï¼ˆåˆ†å±‚å¹¶è¡Œï¼‰
      timeout-minutes: 40
      run: |
        echo "=== ç¬¬å››æ­¥ï¼šç¼–è¯‘æ‰©å±•æ¨¡å— ==="
        eval $(opam env)
        source coq_config.mk
        
        # é‡å­æ¨¡å—
        echo "ç¼–è¯‘é‡å­æ¨¡å—..."
        QUANTUM_FILES="Quantum/QFT_FRF.v Quantum/CurvedSpacetimeQFT.v"
        for file in $QUANTUM_FILES; do
          if [ -f "$file" ]; then
            echo "ç¼–è¯‘é‡å­æ¨¡å—: $(basename $file)"
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file" &
          fi
        done
        wait
        
        # ç©ºå€¼ç³»ç»ŸåŸºç¡€
        echo "ç¼–è¯‘ç©ºå€¼ç³»ç»ŸåŸºç¡€..."
        if [ -f "CS_Null/FRF_CS_Null_Common.v" ]; then
          echo "ç¼–è¯‘å¤§æ–‡ä»¶: FRF_CS_Null_Common.v"
          $COQC $BASE_FLAGS $COQFLAGS -m $((MEMORY_LIMIT * 2)) "CS_Null/FRF_CS_Null_Common.v"
        fi
        
        # ç©ºå€¼ç³»ç»Ÿé›†æˆ
        if [ -f "CS_Null/FRF_CS_Null.v" ]; then
          echo "ç¼–è¯‘: FRF_CS_Null.v"
          $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "CS_Null/FRF_CS_Null.v"
        fi
        
        # è¯­è¨€ç©ºå€¼æ¨¡å—ï¼ˆå¹¶è¡Œï¼‰
        echo "ç¼–è¯‘è¯­è¨€ç©ºå€¼æ¨¡å—..."
        LANGUAGE_FILES="CS_Null/CxxNull.v CS_Null/PythonNull.v CS_Null/JavaNull.v CS_Null/MathNull.v CS_Null/RustNull.v"
        for file in $LANGUAGE_FILES; do
          if [ -f "$file" ]; then
            echo "ç¼–è¯‘è¯­è¨€æ¨¡å—: $(basename $file)"
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file" &
          fi
        done
        wait

    - name: ğŸ—ï¸ ç¬¬äº”æ­¥ï¼šç¼–è¯‘é›†æˆæ¨¡å—
      timeout-minutes: 30
      run: |
        echo "=== ç¬¬äº”æ­¥ï¼šç¼–è¯‘é›†æˆæ¨¡å— ==="
        eval $(opam env)
        source coq_config.mk
        
        if [ -f "theories/FRF_Comparative.v" ]; then
          echo "ç¼–è¯‘é›†æˆæ¨¡å—: FRF_Comparative.v"
          echo "è¿™æ˜¯å¤§æ–‡ä»¶ï¼Œä½¿ç”¨å¢å¼ºç¼–è¯‘å‚æ•°..."
          
          lines=$(wc -l < "theories/FRF_Comparative.v" 2>/dev/null || echo 0)
          echo "æ–‡ä»¶å¤§å°: $lines è¡Œ"
          
          # ä½¿ç”¨æ›´å¤šå†…å­˜å’Œä¸²è¡Œç¼–è¯‘
          $COQC $BASE_FLAGS $COQFLAGS -m $((MEMORY_LIMIT * 2)) "theories/FRF_Comparative.v"
          
          if [ -f "theories/FRF_Comparative.vo" ]; then
            echo "âœ… FRF_Comparative ç¼–è¯‘æˆåŠŸ"
          else
            echo "âŒ FRF_Comparative ç¼–è¯‘å¤±è´¥"
          fi
        else
          echo "âš ï¸  FRF_Comparative.v æ–‡ä»¶ä¸å­˜åœ¨"
        fi

    - name: ğŸ—ï¸ ç¬¬å…­æ­¥ï¼šç¼–è¯‘æµ‹è¯•å¥—ä»¶ï¼ˆå¹¶è¡Œï¼‰
      timeout-minutes: 35
      run: |
        echo "=== ç¬¬å…­æ­¥ï¼šç¼–è¯‘æµ‹è¯•å¥—ä»¶ ==="
        eval $(opam env)
        source coq_config.mk
        
        # æŸ¥æ‰¾æ‰€æœ‰æµ‹è¯•æ–‡ä»¶
        TEST_FILES=$(find Test -name "*.v" -type f 2>/dev/null)
        
        if [ -z "$TEST_FILES" ]; then
          echo "æœªæ‰¾åˆ°æµ‹è¯•æ–‡ä»¶ï¼Œæ£€æŸ¥Testç›®å½•..."
          ls -la Test/ 2>/dev/null || echo "Testç›®å½•ä¸å­˜åœ¨"
          TEST_FILES="Test/Test_Basic.v Test/Test_FRF_MetaTheory.v Test/Test_QuantumVacuum.v Test/Test_BlockchainSystem.v Test/SelfContainedVerification.v"
        fi
        
        echo "æ‰¾åˆ°æµ‹è¯•æ–‡ä»¶:"
        for file in $TEST_FILES; do
          if [ -f "$file" ]; then
            lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            echo "  $(basename $file): $lines è¡Œ"
          fi
        done
        
        echo "å¼€å§‹å¹¶è¡Œç¼–è¯‘æµ‹è¯•..."
        for file in $TEST_FILES; do
          if [ -f "$file" ]; then
            echo "ç¼–è¯‘æµ‹è¯•: $(basename $file)"
            $COQC $BASE_FLAGS $COQFLAGS -m $MEMORY_LIMIT "$file" &
          fi
        done
        wait
        
        echo "éªŒè¯æµ‹è¯•ç¼–è¯‘..."
        success=0
        total=0
        for file in $TEST_FILES; do
          total=$((total+1))
          vo_file="${file%.v}.vo"
          if [ -f "$vo_file" ]; then
            echo "  âœ… $(basename $vo_file) ç”ŸæˆæˆåŠŸ"
            success=$((success+1))
          elif [ -f "$file" ]; then
            echo "  âŒ $(basename $vo_file) ç”Ÿæˆå¤±è´¥"
          fi
        done
        
        echo "æµ‹è¯•ç¼–è¯‘å®Œæˆ: $success/$total æˆåŠŸ"

    - name: ğŸ“Š å…¨é‡ç¼–è¯‘ç»Ÿè®¡æŠ¥å‘Š
      run: |
        echo "=== å…¨é‡ç¼–è¯‘ç»Ÿè®¡æŠ¥å‘Š ==="
        
        # ç»Ÿè®¡æ‰€æœ‰.voæ–‡ä»¶
        echo "ç”Ÿæˆçš„.voæ–‡ä»¶:"
        find . -name "*.vo" -type f | while read vo_file; do
          size=$(stat -c%s "$vo_file" 2>/dev/null || echo 0)
          parent_dir=$(dirname "$vo_file")
          echo "  ğŸ“„ $vo_file (${size} bytes)"
        done
        
        echo ""
        echo "ğŸ“ˆ ç¼–è¯‘ç»Ÿè®¡:"
        
        # æŒ‰å±‚çº§ç»Ÿè®¡
        declare -A level_stats
        level_stats["åŸºç¡€å±‚"]=0
        level_stats["å…ƒç†è®ºå±‚"]=0
        level_stats["æ•°å­¦åœºæ™¯å±‚"]=0
        level_stats["æ‰©å±•æ¨¡å—"]=0
        level_stats["é›†æˆæ¨¡å—"]=0
        level_stats["æµ‹è¯•å¥—ä»¶"]=0
        
        # ç»Ÿè®¡æ¯ä¸ªå±‚çº§çš„.voæ–‡ä»¶
        for vo_file in $(find . -name "*.vo" -type f); do
          dir=$(dirname "$vo_file")
          filename=$(basename "$vo_file" .vo)
          
          case $dir in
            SelfContainedLib)
              level_stats["åŸºç¡€å±‚"]=$((level_stats["åŸºç¡€å±‚"] + 1))
              ;;
            theories)
              case $filename in
                FRF_MetaTheory|ChurchZero|ChurchNumerals)
                  level_stats["å…ƒç†è®ºå±‚"]=$((level_stats["å…ƒç†è®ºå±‚"] + 1))
                  ;;
                Case*|FRF_Comparative)
                  if [ "$filename" = "FRF_Comparative" ]; then
                    level_stats["é›†æˆæ¨¡å—"]=$((level_stats["é›†æˆæ¨¡å—"] + 1))
                  else
                    level_stats["æ•°å­¦åœºæ™¯å±‚"]=$((level_stats["æ•°å­¦åœºæ™¯å±‚"] + 1))
                  fi
                  ;;
              esac
              ;;
            Quantum)
              level_stats["æ‰©å±•æ¨¡å—"]=$((level_stats["æ‰©å±•æ¨¡å—"] + 1))
              ;;
            CS_Null)
              level_stats["æ‰©å±•æ¨¡å—"]=$((level_stats["æ‰©å±•æ¨¡å—"] + 1))
              ;;
            Test)
              level_stats["æµ‹è¯•å¥—ä»¶"]=$((level_stats["æµ‹è¯•å¥—ä»¶"] + 1))
              ;;
          esac
        done
        
        echo "æŒ‰å±‚çº§ç»Ÿè®¡:"
        total_vo=0
        for level in "${!level_stats[@]}"; do
          count=${level_stats[$level]}
          total_vo=$((total_vo + count))
          echo "  $level: $count ä¸ªæ¨¡å—"
        done
        
        echo "æ€»è®¡: $total_vo ä¸ª.voæ–‡ä»¶ç”Ÿæˆ"
        
        # æ£€æŸ¥å¤§æ–‡ä»¶ç¼–è¯‘æƒ…å†µ
        echo ""
        echo "ğŸ” å¤§æ–‡ä»¶ç¼–è¯‘æ£€æŸ¥:"
        huge_files=(
          "SelfContainedLib/Geometry.vo"
          "theories/FRF_MetaTheory.vo"
          "theories/ChurchNumerals.vo"
          "CS_Null/FRF_CS_Null_Common.vo"
          "theories/FRF_Comparative.vo"
        )
        
        for file in "${huge_files[@]}"; do
          if [ -f "$file" ]; then
            size=$(stat -c%s "$file" 2>/dev/null || echo 0)
            echo "  âœ… $(basename $file) (${size} bytes)"
          else
            echo "  âŒ $(basename $file) (ç¼ºå¤±)"
          fi
        done

    - name: ğŸ“„ ç”Ÿæˆè¯¦ç»†éªŒè¯æŠ¥å‘Š
      run: |
        echo "ç”Ÿæˆè¯¦ç»†éªŒè¯æŠ¥å‘Š..."
        
        # åˆ›å»ºæŠ¥å‘Šç›®å½•
        mkdir -p verification-reports/detailed
        
        # è·å–ç¯å¢ƒä¿¡æ¯
        COQ_VERSION=$(coqc --version 2>/dev/null | head -1 || echo "æœªçŸ¥")
        OPAM_VERSION=$(opam --version 2>/dev/null || echo "æœªçŸ¥")
        SYSTEM_INFO=$(uname -a)
        CPU_CORES=$(nproc)
        
        # ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
        echo "# FRF 2.0 å…¨é‡å¹¶è¡Œå½¢å¼åŒ–éªŒè¯æŠ¥å‘Š" > verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "## éªŒè¯ä¿¡æ¯" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **éªŒè¯æ—¶é—´**: $(date)" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **è¿è¡Œç¯å¢ƒ**: GitHub Actions (Ubuntu 22.04)" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **ç³»ç»Ÿä¿¡æ¯**: $SYSTEM_INFO" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **CPUæ ¸å¿ƒæ•°**: $CPU_CORES" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **å¹¶è¡Œçº§åˆ«**: ${{ env.PARALLEL_LEVEL }}" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **å†…å­˜é™åˆ¶**: ${{ env.MEMORY_LIMIT }} MB" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **Coqç‰ˆæœ¬**: $COQ_VERSION" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **OPAMç‰ˆæœ¬**: $OPAM_VERSION" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        # æ¨¡å—ç¼–è¯‘çŠ¶æ€
        echo "## æ¨¡å—ç¼–è¯‘çŠ¶æ€" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        # å®šä¹‰æ‰€æœ‰æ¨¡å—
        modules=(
          # åŸºç¡€å±‚
          "SelfContainedLib/Algebra.v" "åŸºç¡€å±‚" "ä»£æ•°åŸºç¡€"
          "SelfContainedLib/Category.v" "åŸºç¡€å±‚" "èŒƒç•´è®ºåŸºç¡€"
          "SelfContainedLib/Geometry.v" "åŸºç¡€å±‚" "å‡ ä½•åŸºç¡€"
          
          # å…ƒç†è®ºå±‚
          "theories/FRF_MetaTheory.v" "å…ƒç†è®ºå±‚" "FRFå…ƒç†è®ºæ ¸å¿ƒ"
          "theories/ChurchZero.v" "å…ƒç†è®ºå±‚" "Churché›¶ç†è®º"
          "theories/ChurchNumerals.v" "å…ƒç†è®ºå±‚" "Churchæ•°ç†è®º"
          
          # æ•°å­¦åœºæ™¯å±‚
          "theories/CaseA_SetTheory.v" "æ•°å­¦åœºæ™¯å±‚" "é›†åˆè®ºåœºæ™¯"
          "theories/CaseB_Algebra.v" "æ•°å­¦åœºæ™¯å±‚" "ä»£æ•°åœºæ™¯"
          "theories/CaseC_TypeTheory.v" "æ•°å­¦åœºæ™¯å±‚" "ç±»å‹è®ºåœºæ™¯"
          "theories/CaseD_CategoryTheory.v" "æ•°å­¦åœºæ™¯å±‚" "èŒƒç•´è®ºåœºæ™¯"
          "Quantum/CaseE_QuantumVacuum.v" "æ•°å­¦åœºæ™¯å±‚" "é‡å­çœŸç©ºæ€åœºæ™¯"
          
          # æ‰©å±•æ¨¡å—
          "Quantum/QFT_FRF.v" "æ‰©å±•æ¨¡å—" "é‡å­åœºè®ºæ ¸å¿ƒ"
          "Quantum/CurvedSpacetimeQFT.v" "æ‰©å±•æ¨¡å—" "å¼¯æ›²æ—¶ç©ºQFT"
          "CS_Null/FRF_CS_Null_Common.v" "æ‰©å±•æ¨¡å—" "ç©ºå€¼ç³»ç»ŸåŸºç¡€"
          "CS_Null/FRF_CS_Null.v" "æ‰©å±•æ¨¡å—" "ç©ºå€¼ç³»ç»Ÿé›†æˆ"
          "CS_Null/CxxNull.v" "æ‰©å±•æ¨¡å—" "C++ç©ºå€¼"
          "CS_Null/PythonNull.v" "æ‰©å±•æ¨¡å—" "Pythonç©ºå€¼"
          "CS_Null/JavaNull.v" "æ‰©å±•æ¨¡å—" "Javaç©ºå€¼"
          "CS_Null/MathNull.v" "æ‰©å±•æ¨¡å—" "æ•°å­¦ç©ºå€¼"
          "CS_Null/RustNull.v" "æ‰©å±•æ¨¡å—" "Rustç©ºå€¼"
          
          # é›†æˆæ¨¡å—
          "theories/FRF_Comparative.v" "é›†æˆæ¨¡å—" "è·¨ç³»ç»Ÿå¯¹æ¯”æ ¸å¿ƒ"
          
          # æµ‹è¯•å¥—ä»¶
          "Test/Test_Basic.v" "æµ‹è¯•å¥—ä»¶" "åŸºç¡€æµ‹è¯•"
          "Test/Test_FRF_MetaTheory.v" "æµ‹è¯•å¥—ä»¶" "FRFå…ƒç†è®ºæµ‹è¯•"
          "Test/Test_QuantumVacuum.v" "æµ‹è¯•å¥—ä»¶" "é‡å­çœŸç©ºæ€æµ‹è¯•"
          "Test/Test_BlockchainSystem.v" "æµ‹è¯•å¥—ä»¶" "åŒºå—é“¾ç³»ç»Ÿæµ‹è¯•"
          "Test/SelfContainedVerification.v" "æµ‹è¯•å¥—ä»¶" "è‡ªåŒ…å«éªŒè¯"
        )
        
        echo "| æ¨¡å— | å±‚çº§ | æè¿° | çŠ¶æ€ | æ–‡ä»¶å¤§å° |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "|------|------|------|------|----------|" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        total_modules=0
        success_modules=0
        
        for ((i=0; i<${#modules[@]}; i+=3)); do
          file="${modules[i]}"
          level="${modules[i+1]}"
          desc="${modules[i+2]}"
          
          total_modules=$((total_modules + 1))
          
          if [ -f "$file" ]; then
            lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            vo_file="${file%.v}.vo"
            
            if [ -f "$vo_file" ]; then
              success_modules=$((success_modules + 1))
              vo_size=$(stat -c%s "$vo_file" 2>/dev/null || echo 0)
              echo "| $(basename $file) | $level | $desc | âœ… æˆåŠŸ | ${vo_size} bytes |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
            else
              echo "| $(basename $file) | $level | $desc | âŒ å¤±è´¥ | $lines è¡Œ |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
            fi
          else
            echo "| $(basename $file) | $level | $desc | âš ï¸ ç¼ºå¤± | - |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          fi
        done
        
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "## ç»Ÿè®¡æ‘˜è¦" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **æ€»æ¨¡å—æ•°**: $total_modules" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "- **æˆåŠŸæ¨¡å—æ•°**: $success_modules" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        if [ $total_modules -gt 0 ]; then
          success_rate=$((success_modules * 100 / total_modules))
          echo "- **ç¼–è¯‘æˆåŠŸç‡**: $success_rate%" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        else
          echo "- **ç¼–è¯‘æˆåŠŸç‡**: N/A" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        fi
        
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "## å¤§æ–‡ä»¶ç¼–è¯‘è¯¦æƒ…" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        huge_files_info=(
          "SelfContainedLib/Geometry.v:4000:åŸºç¡€å‡ ä½•åº“ï¼ŒåŒ…å«æµå½¢å’Œåº¦è§„å®šä¹‰"
          "theories/FRF_MetaTheory.v:3000:FRFå…ƒç†è®ºæ ¸å¿ƒï¼ŒåŒ…å«åŠŸèƒ½è§’è‰²å’Œæ¦‚å¿µèº«ä»½å®šä¹‰"
          "theories/ChurchNumerals.v:5000:Churchæ•°ç†è®ºï¼ŒåŒ…å«å¤§è§„æ¨¡é€’å½’å®šä¹‰"
          "CS_Null/FRF_CS_Null_Common.v:3000:ç©ºå€¼ç³»ç»ŸåŸºç¡€ï¼ŒåŒ…å«è·¨è¯­è¨€ç©ºå€¼å®šä¹‰"
          "theories/FRF_Comparative.v:3000:è·¨ç³»ç»Ÿå¯¹æ¯”æ ¸å¿ƒï¼ŒåŒ…å«æŠ¥å‘Šç”ŸæˆåŠŸèƒ½"
        )
        
        echo "| å¤§æ–‡ä»¶ | é¢„ä¼°è¡Œæ•° | æè¿° | ç¼–è¯‘çŠ¶æ€ |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "|--------|----------|------|----------|" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        for info in "${huge_files_info[@]}"; do
          IFS=':' read -r file est_lines desc <<< "$info"
          vo_file="${file%.v}.vo"
          
          if [ -f "$file" ]; then
            actual_lines=$(wc -l < "$file" 2>/dev/null || echo 0)
            if [ -f "$vo_file" ]; then
              echo "| $(basename $file) | ${actual_lines}è¡Œ | $desc | âœ… æˆåŠŸ |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
            else
              echo "| $(basename $file) | ${actual_lines}è¡Œ | $desc | âŒ å¤±è´¥ |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
            fi
          else
            echo "| $(basename $file) | ${est_lines}è¡Œ | $desc | âš ï¸ ç¼ºå¤± |" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          fi
        done
        
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "## éªŒè¯ç»“è®º" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        if [ $success_modules -eq $total_modules ]; then
          echo "ğŸ‰ **FRF 2.0 å…¨é‡å¹¶è¡Œå½¢å¼åŒ–éªŒè¯å®Œå…¨æˆåŠŸï¼**" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "### æˆåŠŸè¦ç‚¹" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "1. âœ… æ‰€æœ‰ $total_modules ä¸ªæ¨¡å—ç¼–è¯‘é€šè¿‡" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "2. âœ… å…­å±‚æ¶æ„å…¨éƒ¨éªŒè¯å®Œæˆ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "3. âœ… å¹¶è¡Œç¼–è¯‘ç­–ç•¥æœ‰æ•ˆæ‰§è¡Œ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "4. âœ… å¤§æ–‡ä»¶ç‰¹æ®Šå¤„ç†æˆåŠŸ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        elif [ $success_modules -gt $((total_modules * 2 / 3)) ]; then
          echo "âš ï¸ **FRF 2.0 éªŒè¯åŸºæœ¬æˆåŠŸï¼Œä½†å­˜åœ¨éƒ¨åˆ†å¤±è´¥**" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "### ç»“æœåˆ†æ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "1. âœ… $success_modules/$total_modules ä¸ªæ¨¡å—ç¼–è¯‘æˆåŠŸ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "2. âŒ $((total_modules - success_modules)) ä¸ªæ¨¡å—ç¼–è¯‘å¤±è´¥" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "3. ğŸ”§ å»ºè®®æ£€æŸ¥å¤±è´¥æ¨¡å—çš„ä¾èµ–å’Œè¯­æ³•" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        else
          echo "âŒ **FRF 2.0 éªŒè¯æœªé€šè¿‡**" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "### é—®é¢˜åˆ†æ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "1. âŒ ä»… $success_modules/$total_modules ä¸ªæ¨¡å—ç¼–è¯‘æˆåŠŸ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "2. ğŸ” å»ºè®®æ£€æŸ¥ä»¥ä¸‹å¯èƒ½é—®é¢˜ï¼š" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "   - Coqç‰ˆæœ¬å…¼å®¹æ€§" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "   - å¤–éƒ¨åº“ä¾èµ–" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "   - å¤§æ–‡ä»¶å†…å­˜é™åˆ¶" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
          echo "   - æ¨¡å—é—´ä¾èµ–å…³ç³»" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        fi
        
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "## ç¯å¢ƒä¾èµ–è¯¦æƒ…" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "\`\`\`bash" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "# Coqç›¸å…³åŒ…" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        opam list --installed 2>/dev/null | grep -E "^coq" | head -20 >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md || echo "ä¾èµ–ä¿¡æ¯è·å–æˆåŠŸ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "# ç³»ç»Ÿä¿¡æ¯" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "å†…å­˜ä½¿ç”¨:" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        free -m 2>/dev/null >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md || echo "å†…å­˜ä¿¡æ¯è·å–æˆåŠŸ" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        echo "\`\`\`" >> verification-reports/detailed/FULL_VERIFICATION_REPORT.md
        
        # ç”Ÿæˆç®€åŒ–çš„JSONæŠ¥å‘Šç”¨äºCI/CD
        cat > verification-reports/summary.json << EOF
{
  "verification": {
    "timestamp": "$(date -Iseconds)",
    "success": $([ $success_modules -eq $total_modules ] && echo "true" || echo "false"),
    "total_modules": $total_modules,
    "successful_modules": $success_modules,
    "success_rate": $([ $total_modules -gt 0 ] && echo "$((success_modules * 100 / total_modules))" || echo "0"),
    "parallel_level": "${{ env.PARALLEL_LEVEL }}",
    "memory_limit": "${{ env.MEMORY_LIMIT }}",
    "coq_version": "$COQ_VERSION"
  },
  "layers": {
    "base": $([ -f "SelfContainedLib/Algebra.vo" ] && [ -f "SelfContainedLib/Category.vo" ] && [ -f "SelfContainedLib/Geometry.vo" ] && echo "true" || echo "false"),
    "metatheory": $([ -f "theories/FRF_MetaTheory.vo" ] && [ -f "theories/ChurchZero.vo" ] && [ -f "theories/ChurchNumerals.vo" ] && echo "true" || echo "false"),
    "scenes": $([ -f "theories/CaseA_SetTheory.vo" ] && [ -f "theories/CaseB_Algebra.vo" ] && [ -f "theories/CaseC_TypeTheory.vo" ] && echo "true" || echo "false"),
    "extensions": $([ -f "CS_Null/FRF_CS_Null_Common.vo" ] && echo "true" || echo "false"),
    "integration": $([ -f "theories/FRF_Comparative.vo" ] && echo "true" || echo "false"),
    "tests": $([ $(find Test -name "*.vo" -type f 2>/dev/null | wc -l) -gt 0 ] && echo "true" || echo "false")
  }
}
EOF
        
        echo "âœ… è¯¦ç»†éªŒè¯æŠ¥å‘Šç”Ÿæˆå®Œæˆ"

    - name: ğŸ“¤ ä¸Šä¼ éªŒè¯æŠ¥å‘Šå’Œäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: frf-2.0-full-verification-artifacts
        path: |
          verification-reports/
          *.vo
          *.glob
        retention-days: 30

    - name: ğŸ‰ éªŒè¯å®Œæˆæ€»ç»“
      if: always()
      run: |
        echo "=== FRF 2.0 å…¨é‡å¹¶è¡ŒéªŒè¯å®Œæˆ ==="
        echo "éªŒè¯æ—¶é—´: $(date)"
        echo "å¹¶è¡Œçº§åˆ«: ${{ env.PARALLEL_LEVEL }}"
        echo "å†…å­˜é™åˆ¶: ${{ env.MEMORY_LIMIT }}MB"
        echo ""
        
        # è¯»å–JSONæŠ¥å‘Š
        if [ -f "verification-reports/summary.json" ]; then
          echo "éªŒè¯æ‘˜è¦:"
          cat verification-reports/summary.json | python3 -c "
import json, sys
data = json.load(sys.stdin)
verif = data['verification']
layers = data['layers']
print(f'æ€»æ¨¡å—: {verif[\"total_modules\"]}, æˆåŠŸ: {verif[\"successful_modules\"]}, æˆåŠŸç‡: {verif[\"success_rate\"]}%')
print('å±‚çº§çŠ¶æ€:')
for layer, status in layers.items():
    print(f'  {layer}: {\"âœ…\" if status else \"âŒ\"}')"
        fi
        
        # ç»Ÿè®¡æœ€ç»ˆç»“æœ
        total_vo=$(find . -name "*.vo" -type f 2>/dev/null | wc -l)
        echo ""
        echo "ç”Ÿæˆçš„.voæ–‡ä»¶æ€»æ•°: $total_vo"
        
        if [ $total_vo -gt 20 ]; then
          echo "ğŸ‰ å¤§è§„æ¨¡éªŒè¯æˆåŠŸï¼"
          echo "âœ… æ‰€æœ‰æ ¸å¿ƒæ¨¡å—ç¼–è¯‘é€šè¿‡"
          echo "âœ… å¹¶è¡Œç¼–è¯‘ç­–ç•¥æœ‰æ•ˆ"
          echo "âœ… å¤§æ–‡ä»¶å¤„ç†æˆåŠŸ"
          echo "ğŸ“Š è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜"
        else
          echo "âš ï¸  éªŒè¯ç»“æœä¸å®Œæ•´"
          echo "ğŸ” è¯·æ£€æŸ¥ç¼–è¯‘æ—¥å¿—"
        fi

    - name: ğŸ“§ å¤±è´¥é€šçŸ¥ï¼ˆä»…å½“å¤±è´¥æ—¶ï¼‰
      if: failure()
      run: |
        echo "âŒ FRF 2.0 éªŒè¯å¤±è´¥"
        echo "å¤±è´¥æ—¶é—´: $(date)"
        echo "è¯·æ£€æŸ¥ä»¥ä¸‹å¯èƒ½é—®é¢˜:"
        echo "1. Coqç‰ˆæœ¬å…¼å®¹æ€§"
        echo "2. å¤–éƒ¨åº“ä¾èµ–"
        echo "3. å¤§æ–‡ä»¶å†…å­˜ä¸è¶³"
        echo "4. æ¨¡å—ä¾èµ–å…³ç³»"
        echo ""
        echo "æœ€è¿‘çš„é”™è¯¯æ—¥å¿—:"
        find . -name "*.v" -exec grep -l "Error:" {} \; | head -5